{"ast":null,"code":"var _jsxFileName = \"/Users/stepan12/Documents/characters/Characters-app/src/pages/Characters/Characters.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport './Characters.scss';\nimport CardList from '../../components/CardList/CardList';\nimport Pagination from '../../components/Pagination/Pagination';\nimport UserMenu from '../../components/UserMenu/UserMenu';\nimport Logo from '../../components/Logo/Logo';\nimport { filterByName } from '../../helpers/heplerFunction';\nimport { getCharacters } from '../../api/api';\nimport SearchIcon from '../../image/search.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Characters = _ref => {\n  _s();\n  let {\n    userName\n  } = _ref;\n  const [characters, setCharacters] = useState([]);\n  const [query, setQuery] = useState('');\n  const [visiableCharacters, setVisiableCharacters] = useState([]);\n  const [newQuery, setNewQuery] = useState('');\n  const firstPage = 1;\n  const countCardsOfPage = 8;\n  const [currentPage, setCurrentPage] = useState(firstPage);\n  const [recordsPerPage] = useState(countCardsOfPage);\n  const indexOfLastRecord = currentPage * recordsPerPage;\n  const indexOfFirstRecord = indexOfLastRecord - recordsPerPage;\n  const currentRecords = visiableCharacters.slice(indexOfFirstRecord, indexOfLastRecord);\n  const nPages = Math.ceil(visiableCharacters.length / recordsPerPage);\n  const getQuery = sessionStorage.getItem('query') || '';\n  const getCurrentPage = sessionStorage.getItem('currentPage') ? Number(sessionStorage.getItem('currentPage')) : firstPage;\n  const checkIsNewQuery = newQuery !== null;\n  const handlerChange = event => {\n    setQuery(event.target.value);\n  };\n  useEffect(() => {\n    if (userName) {\n      window.sessionStorage.setItem('userName', JSON.stringify(userName));\n    }\n  }, [userName]);\n  const handlerReturnToMainPage = () => {\n    window.sessionStorage.setItem('currentPage', JSON.stringify(String(firstPage)));\n    window.location.reload();\n  };\n  useEffect(() => {\n    if (visiableCharacters.length < countCardsOfPage + 1) {\n      setCurrentPage(firstPage);\n    }\n  }, [visiableCharacters.length]);\n  useEffect(() => {\n    getCharacters(setCharacters);\n  }, []);\n  useEffect(() => {\n    setVisiableCharacters(filterByName(characters, query));\n  }, [characters, query]);\n  useEffect(() => {\n    if (checkIsNewQuery && query.length !== newQuery.length) {\n      window.sessionStorage.setItem('query', JSON.stringify(query));\n    }\n    if (currentPage >= firstPage) {\n      window.sessionStorage.setItem('currentPage', JSON.stringify(currentPage));\n    }\n  }, [query, currentPage]);\n  useEffect(() => {\n    if (checkIsNewQuery) {\n      setQuery(newQuery);\n    }\n  }, [newQuery]);\n  useEffect(() => {\n    if (checkIsNewQuery && getQuery) {\n      setNewQuery(JSON.parse(getQuery));\n    }\n  }, [getQuery]);\n  useEffect(() => {\n    if (getCurrentPage && getCurrentPage > firstPage) {\n      setCurrentPage(getCurrentPage);\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home-page\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"home-page__content\",\n      children: [/*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"content\",\n        children: [/*#__PURE__*/_jsxDEV(UserMenu, {\n          userName: userName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"header\", {\n          className: \"content-header\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"/Characters-app/#/characters/#/\",\n            className: \"home-page__logo\",\n            onClick: handlerReturnToMainPage,\n            children: /*#__PURE__*/_jsxDEV(Logo, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"search-form\",\n          children: /*#__PURE__*/_jsxDEV(\"label\", {\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              className: \"search-form__icon\",\n              src: SearchIcon,\n              alt: \"SearchIcon\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              className: \"search-form__input\",\n              type: \"text\",\n              defaultValue: newQuery || '',\n              name: \"search\",\n              placeholder: \"Filter by name...\",\n              onChange: handlerChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CardList, {\n          characters: currentRecords\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n        className: \"pagination\",\n        children: /*#__PURE__*/_jsxDEV(Pagination, {\n          nPages: nPages,\n          currentPage: currentPage,\n          setCurrentPage: setCurrentPage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this);\n};\n_s(Characters, \"9EOxJMnKSIwPcGH96nQq5GNYiK8=\");\n_c = Characters;\nexport default Characters;\nvar _c;\n$RefreshReg$(_c, \"Characters\");","map":{"version":3,"names":["React","useEffect","useState","CardList","Pagination","UserMenu","Logo","filterByName","getCharacters","SearchIcon","jsxDEV","_jsxDEV","Characters","_ref","_s","userName","characters","setCharacters","query","setQuery","visiableCharacters","setVisiableCharacters","newQuery","setNewQuery","firstPage","countCardsOfPage","currentPage","setCurrentPage","recordsPerPage","indexOfLastRecord","indexOfFirstRecord","currentRecords","slice","nPages","Math","ceil","length","getQuery","sessionStorage","getItem","getCurrentPage","Number","checkIsNewQuery","handlerChange","event","target","value","window","setItem","JSON","stringify","handlerReturnToMainPage","String","location","reload","parse","className","children","fileName","_jsxFileName","lineNumber","columnNumber","href","onClick","src","alt","type","defaultValue","name","placeholder","onChange","_c","$RefreshReg$"],"sources":["/Users/stepan12/Documents/characters/Characters-app/src/pages/Characters/Characters.tsx"],"sourcesContent":["import React, { ChangeEvent, useEffect, useState } from 'react';\nimport './Characters.scss';\n\nimport CardList from '../../components/CardList/CardList';\nimport Pagination from '../../components/Pagination/Pagination';\nimport UserMenu from '../../components/UserMenu/UserMenu';\nimport Logo from '../../components/Logo/Logo';\n\nimport { filterByName } from '../../helpers/heplerFunction';\nimport { getCharacters } from '../../api/api';\n\nimport { Character } from '../../types';\n\nimport SearchIcon from '../../image/search.png';\n\ntype Props = {\n  userName: string;\n}\n\nconst Characters: React.FC<Props> = ({ userName }) => {\n  const [characters, setCharacters] = useState<Character[]>([]);\n  const [query, setQuery] = useState<string>('');\n  const [visiableCharacters, setVisiableCharacters] = useState<Character[]>([])\n  const [newQuery, setNewQuery] = useState<string>('')\n\n  const firstPage = 1;\n  const countCardsOfPage = 8;\n\n  const [currentPage, setCurrentPage] = useState(firstPage);\n  const [recordsPerPage] = useState(countCardsOfPage);\n  \n  const indexOfLastRecord = currentPage * recordsPerPage;\n  const indexOfFirstRecord = indexOfLastRecord - recordsPerPage;\n  const currentRecords = visiableCharacters.slice(indexOfFirstRecord, indexOfLastRecord);\n  const nPages = Math.ceil(visiableCharacters.length / recordsPerPage)\n\n  const getQuery = sessionStorage.getItem('query') || '';\n  \n  const getCurrentPage = sessionStorage.getItem('currentPage')\n    ?  Number(sessionStorage.getItem('currentPage'))\n    :  firstPage;\n\n  const checkIsNewQuery = newQuery !== null;\n\n  const handlerChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setQuery(event.target.value)\n  }\n\n  useEffect(() => {\n    if (userName) {\n      window.sessionStorage.setItem('userName', JSON.stringify(userName));\n    }\n  }, [userName]);\n\n  const handlerReturnToMainPage = () => {\n    window.sessionStorage.setItem('currentPage', JSON.stringify(String(firstPage)))\n    window.location.reload();\n  }\n\n  useEffect(() => {\n    if (visiableCharacters.length < (countCardsOfPage + 1)) {\n      setCurrentPage(firstPage);\n    }\n  }, [visiableCharacters.length])\n\n  useEffect(() => {\n    getCharacters(setCharacters);\n  }, [])\n\n  useEffect(() => {    \n    setVisiableCharacters(filterByName(characters, query));\n  }, [characters, query])\n\n  useEffect(() => {\n    if (checkIsNewQuery && query.length !== newQuery.length) {\n      window.sessionStorage.setItem('query', JSON.stringify(query));\n    }\n\n    if (currentPage >= firstPage) {\n      window.sessionStorage.setItem('currentPage', JSON.stringify(currentPage));\n    }\n  }, [query, currentPage])\n\n\n  useEffect(() => {\n    if (checkIsNewQuery) {\n      setQuery(newQuery);\n    }\n  }, [newQuery])\n\n  useEffect(() => {\n    if (checkIsNewQuery && getQuery) {\n      setNewQuery(JSON.parse(getQuery));\n    } \n  }, [getQuery])\n\n  useEffect(() => {\n    if (getCurrentPage && getCurrentPage > firstPage) {\n      setCurrentPage(getCurrentPage);\n    } \n  }, [])\n\n\n  return (\n    <div className='home-page'>\n      <div className='home-page__content'>\n        <section className='content'>\n          <UserMenu \n            userName={userName} \n          />\n\n          <header className='content-header'>\n            <a \n              href='/Characters-app/#/characters/#/'\n              className='home-page__logo'\n              onClick={handlerReturnToMainPage}\n            >\n              <Logo />\n            </a>\n          </header>\n          \n          <form\n            className=\"search-form\"\n          >\n            <label>\n              <img\n                className='search-form__icon'\n                src={SearchIcon}\n                alt='SearchIcon'\n              />\n\n              <input \n                className=\"search-form__input\"\n                type=\"text\"\n                defaultValue={newQuery || ''}\n                name=\"search\"\n                placeholder=\"Filter by name...\"\n                onChange={handlerChange}\n              />\n            </label>\n          </form>\n\n          <CardList characters={currentRecords} />\n        </section>\n        \n        <section className='pagination'>\n          <Pagination\n            nPages={nPages}\n            currentPage={currentPage}\n            setCurrentPage={setCurrentPage}\n          />\n        </section>\n      </div>\n    </div>\n  )\n}\n\nexport default Characters;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}