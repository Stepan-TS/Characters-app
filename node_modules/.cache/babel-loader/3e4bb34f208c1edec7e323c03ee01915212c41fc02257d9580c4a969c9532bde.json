{"ast":null,"code":"import _slicedToArray from\"/Users/stepan12/Documents/characters/Characters-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import'./Characters.scss';import CardList from'../../components/CardList/CardList';import Pagination from'../../components/Pagination/Pagination';import UserMenu from'../../components/UserMenu/UserMenu';import Logo from'../../components/Logo/Logo';import{filterByName}from'../../helpers/heplerFunction';import{getCharacters}from'../../api/api';import SearchIcon from'../../image/search.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Characters=function Characters(_ref){var userName=_ref.userName;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),characters=_useState2[0],setCharacters=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),query=_useState4[0],setQuery=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),visiableCharacters=_useState6[0],setVisiableCharacters=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),newQuery=_useState8[0],setNewQuery=_useState8[1];var firstPage=1;var countCardsOfPage=8;var _useState9=useState(firstPage),_useState10=_slicedToArray(_useState9,2),currentPage=_useState10[0],setCurrentPage=_useState10[1];var _useState11=useState(countCardsOfPage),_useState12=_slicedToArray(_useState11,1),recordsPerPage=_useState12[0];var indexOfLastRecord=currentPage*recordsPerPage;var indexOfFirstRecord=indexOfLastRecord-recordsPerPage;var currentRecords=visiableCharacters.slice(indexOfFirstRecord,indexOfLastRecord);var nPages=Math.ceil(visiableCharacters.length/recordsPerPage);var getQuery=localStorage.getItem('query')||'';var getCurrentPage=localStorage.getItem('currentPage')?Number(localStorage.getItem('currentPage')):firstPage;var getUserName=localStorage.getItem('userName')||'';var checkIsNewQuery=newQuery!==null;var handlerChange=function handlerChange(event){setQuery(event.target.value);};var handlerReturnToMainPage=function handlerReturnToMainPage(){window.localStorage.setItem('currentPage',JSON.stringify(String(firstPage)));window.location.reload();};useEffect(function(){window.localStorage.setItem('userName',JSON.stringify(userName));},[userName]);useEffect(function(){if(visiableCharacters.length<countCardsOfPage+1){setCurrentPage(firstPage);}},[visiableCharacters.length]);useEffect(function(){getCharacters(setCharacters);},[]);useEffect(function(){setVisiableCharacters(filterByName(characters,query));},[characters,query]);useEffect(function(){if(checkIsNewQuery&&query.length!==newQuery.length){window.localStorage.setItem('query',JSON.stringify(query));}if(currentPage>=firstPage){window.localStorage.setItem('currentPage',JSON.stringify(currentPage));}},[query,currentPage]);useEffect(function(){if(checkIsNewQuery){setQuery(newQuery);}},[newQuery]);useEffect(function(){if(checkIsNewQuery){setNewQuery(JSON.parse(getQuery));}},[getQuery]);useEffect(function(){if(getCurrentPage&&getCurrentPage>firstPage){setCurrentPage(getCurrentPage);}},[]);console.log(getUserName);return/*#__PURE__*/_jsx(\"div\",{className:\"home-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"home-page__content\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"content\",children:[/*#__PURE__*/_jsx(UserMenu,{userName:getUserName,setQuery:setQuery}),/*#__PURE__*/_jsx(\"header\",{className:\"content-header\",children:/*#__PURE__*/_jsx(\"a\",{href:\"/Characters-app/#/characters/#/\",className:\"home-page__logo\",onClick:handlerReturnToMainPage,children:/*#__PURE__*/_jsx(Logo,{})})}),/*#__PURE__*/_jsx(\"form\",{className:\"search-form\",children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"img\",{className:\"search-form__icon\",src:SearchIcon,alt:\"SearchIcon\"}),/*#__PURE__*/_jsx(\"input\",{className:\"search-form__input\",type:\"text\",defaultValue:newQuery||'',name:\"search\",placeholder:\"Filter by name...\",onChange:handlerChange})]})}),/*#__PURE__*/_jsx(CardList,{characters:currentRecords})]}),/*#__PURE__*/_jsx(\"section\",{className:\"pagination\",children:/*#__PURE__*/_jsx(Pagination,{nPages:nPages,currentPage:currentPage,setCurrentPage:setCurrentPage})})]})});};export default Characters;","map":{"version":3,"names":["React","useEffect","useState","CardList","Pagination","UserMenu","Logo","filterByName","getCharacters","SearchIcon","jsx","_jsx","jsxs","_jsxs","Characters","_ref","userName","_useState","_useState2","_slicedToArray","characters","setCharacters","_useState3","_useState4","query","setQuery","_useState5","_useState6","visiableCharacters","setVisiableCharacters","_useState7","_useState8","newQuery","setNewQuery","firstPage","countCardsOfPage","_useState9","_useState10","currentPage","setCurrentPage","_useState11","_useState12","recordsPerPage","indexOfLastRecord","indexOfFirstRecord","currentRecords","slice","nPages","Math","ceil","length","getQuery","localStorage","getItem","getCurrentPage","Number","getUserName","checkIsNewQuery","handlerChange","event","target","value","handlerReturnToMainPage","window","setItem","JSON","stringify","String","location","reload","parse","console","log","className","children","href","onClick","src","alt","type","defaultValue","name","placeholder","onChange"],"sources":["/Users/stepan12/Documents/characters/Characters-app/src/pages/Characters/Characters.tsx"],"sourcesContent":["import React, { ChangeEvent, useEffect, useState } from 'react';\nimport './Characters.scss';\n\nimport CardList from '../../components/CardList/CardList';\nimport Pagination from '../../components/Pagination/Pagination';\nimport UserMenu from '../../components/UserMenu/UserMenu';\nimport Logo from '../../components/Logo/Logo';\n\nimport { filterByName } from '../../helpers/heplerFunction';\nimport { getCharacters } from '../../api/api';\n\nimport { Character } from '../../types';\n\nimport SearchIcon from '../../image/search.png';\n\ntype Props = {\n  userName: string;\n}\n\nconst Characters: React.FC<Props> = ({ userName }) => {\n  const [characters, setCharacters] = useState<Character[]>([]);\n  const [query, setQuery] = useState<string>('');\n  const [visiableCharacters, setVisiableCharacters] = useState<Character[]>([])\n  const [newQuery, setNewQuery] = useState<string>('')\n\n  const firstPage = 1;\n  const countCardsOfPage = 8;\n\n  const [currentPage, setCurrentPage] = useState(firstPage);\n  const [recordsPerPage] = useState(countCardsOfPage);\n  \n  const indexOfLastRecord = currentPage * recordsPerPage;\n  const indexOfFirstRecord = indexOfLastRecord - recordsPerPage;\n  const currentRecords = visiableCharacters.slice(indexOfFirstRecord, indexOfLastRecord);\n  const nPages = Math.ceil(visiableCharacters.length / recordsPerPage)\n\n  const getQuery = localStorage.getItem('query') || '';\n  \n  const getCurrentPage = localStorage.getItem('currentPage')\n    ?  Number(localStorage.getItem('currentPage'))\n    :  firstPage;\n\n  const getUserName = localStorage.getItem('userName') || '';\n\n  const checkIsNewQuery = newQuery !== null;\n\n  const handlerChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setQuery(event.target.value)\n  }\n\n  const handlerReturnToMainPage = () => {\n    window.localStorage.setItem('currentPage', JSON.stringify(String(firstPage)))\n    window.location.reload();\n  }\n\n  useEffect(() => {\n    window.localStorage.setItem('userName', JSON.stringify(userName));\n  }, [userName]);\n\n  useEffect(() => {\n    if (visiableCharacters.length < (countCardsOfPage + 1)) {\n      setCurrentPage(firstPage);\n    }\n  }, [visiableCharacters.length])\n\n  useEffect(() => {\n    getCharacters(setCharacters);\n  }, [])\n\n  useEffect(() => {    \n    setVisiableCharacters(filterByName(characters, query));\n  }, [characters, query])\n\n  useEffect(() => {\n    if (checkIsNewQuery && query.length !== newQuery.length) {\n      window.localStorage.setItem('query', JSON.stringify(query));\n    }\n\n    if (currentPage >= firstPage) {\n      window.localStorage.setItem('currentPage', JSON.stringify(currentPage));\n    }\n  }, [query, currentPage])\n\n\n  useEffect(() => {\n    if (checkIsNewQuery) {\n      setQuery(newQuery);\n    }\n  }, [newQuery])\n\n  useEffect(() => {\n    if (checkIsNewQuery) {\n      setNewQuery(JSON.parse(getQuery));\n    } \n  }, [getQuery])\n\n  useEffect(() => {\n    if (getCurrentPage && getCurrentPage > firstPage) {\n      setCurrentPage(getCurrentPage);\n    } \n  }, [])\n  console.log(getUserName);\n  return (\n    <div className='home-page'>\n      <div className='home-page__content'>\n        <section className='content'>\n          <UserMenu \n            userName={getUserName} \n            setQuery={setQuery}\n          />\n\n          <header className='content-header'>\n            <a \n              href='/Characters-app/#/characters/#/'\n              className='home-page__logo'\n              onClick={handlerReturnToMainPage}\n            >\n              <Logo />\n            </a>\n          </header>\n          \n          <form\n            className=\"search-form\"\n          >\n            <label>\n              <img\n                className='search-form__icon'\n                src={SearchIcon}\n                alt='SearchIcon'\n              />\n\n              <input \n                className=\"search-form__input\"\n                type=\"text\"\n                defaultValue={newQuery || ''}\n                name=\"search\"\n                placeholder=\"Filter by name...\"\n                onChange={handlerChange}\n              />\n            </label>\n          </form>\n\n          <CardList characters={currentRecords} />\n        </section>\n        \n        <section className='pagination'>\n          <Pagination\n            nPages={nPages}\n            currentPage={currentPage}\n            setCurrentPage={setCurrentPage}\n          />\n        </section>\n      </div>\n    </div>\n  )\n}\n\nexport default Characters;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}