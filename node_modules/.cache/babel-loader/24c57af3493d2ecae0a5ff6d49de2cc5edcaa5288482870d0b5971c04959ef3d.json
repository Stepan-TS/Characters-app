{"ast":null,"code":"import _slicedToArray from\"/Users/stepan12/Documents/characters/Characters-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import'./Characters.scss';import CardList from'../../components/CardList/CardList';import Pagination from'../../components/Pagination/Pagination';import UserMenu from'../../components/UserMenu/UserMenu';import Logo from'../../components/Logo/Logo';import{filterByName}from'../../helpers/heplerFunction';import{getCharacters}from'../../api/api';import SearchIcon from'../../image/search.png';import NoResults from'../../components/NoResults/NoResults';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Characters=function Characters(_ref){var userName=_ref.userName;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),characters=_useState2[0],setCharacters=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),query=_useState4[0],setQuery=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),visiableCharacters=_useState6[0],setVisiableCharacters=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),newQuery=_useState8[0],setNewQuery=_useState8[1];var firstPage=1;var countCardsOfPage=8;var _useState9=useState(firstPage),_useState10=_slicedToArray(_useState9,2),currentPage=_useState10[0],setCurrentPage=_useState10[1];var _useState11=useState(countCardsOfPage),_useState12=_slicedToArray(_useState11,1),recordsPerPage=_useState12[0];var indexOfLastRecord=currentPage*recordsPerPage;var indexOfFirstRecord=indexOfLastRecord-recordsPerPage;var currentRecords=visiableCharacters.slice(indexOfFirstRecord,indexOfLastRecord);var nPages=Math.ceil(visiableCharacters.length/recordsPerPage);var getQuery=sessionStorage.getItem('query')||'';var getCurrentPage=sessionStorage.getItem('currentPage')?Number(sessionStorage.getItem('currentPage')):firstPage;var checkIsNewQuery=newQuery!==null;var handleChange=function handleChange(event){setQuery(event.target.value);};var handleReturnToMainPage=function handleReturnToMainPage(){window.sessionStorage.setItem('currentPage',JSON.stringify(String(firstPage)));window.location.reload();};useEffect(function(){if(userName){window.sessionStorage.setItem('userName',JSON.stringify(userName));}},[userName]);useEffect(function(){if(visiableCharacters.length<countCardsOfPage+1){setCurrentPage(firstPage);}},[visiableCharacters.length]);useEffect(function(){getCharacters(setCharacters);},[]);useEffect(function(){setVisiableCharacters(filterByName(characters,query));},[characters,query]);useEffect(function(){if(checkIsNewQuery&&query.length!==newQuery.length){window.sessionStorage.setItem('query',JSON.stringify(query));}if(currentPage>=firstPage){window.sessionStorage.setItem('currentPage',JSON.stringify(currentPage));}},[query,currentPage]);useEffect(function(){if(checkIsNewQuery){setQuery(newQuery);}},[newQuery]);useEffect(function(){if(checkIsNewQuery&&getQuery){setNewQuery(JSON.parse(getQuery));}},[getQuery]);useEffect(function(){if(getCurrentPage&&getCurrentPage>firstPage){setCurrentPage(getCurrentPage);}},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"home-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"home-page__content\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"content\",children:[/*#__PURE__*/_jsx(UserMenu,{userName:userName}),/*#__PURE__*/_jsx(\"header\",{className:\"content-header\",children:/*#__PURE__*/_jsx(\"a\",{href:\"/Characters-app/#/characters/#/\",className:\"home-page__logo\",onClick:handleReturnToMainPage,children:/*#__PURE__*/_jsx(Logo,{})})}),/*#__PURE__*/_jsx(\"form\",{className:\"search-form\",children:/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"img\",{className:\"search-form__icon\",src:SearchIcon,alt:\"SearchIcon\"}),/*#__PURE__*/_jsx(\"input\",{className:\"search-form__input\",type:\"text\",defaultValue:newQuery||'',name:\"search\",placeholder:\"Filter by name...\",onChange:handleChange})]})}),currentRecords.length!==0?/*#__PURE__*/_jsx(CardList,{characters:currentRecords}):/*#__PURE__*/_jsx(NoResults,{})]}),/*#__PURE__*/_jsx(\"section\",{className:\"pagination\",children:/*#__PURE__*/_jsx(Pagination,{nPages:nPages,currentPage:currentPage,setCurrentPage:setCurrentPage})})]})});};export default Characters;","map":{"version":3,"names":["React","useEffect","useState","CardList","Pagination","UserMenu","Logo","filterByName","getCharacters","SearchIcon","NoResults","jsx","_jsx","jsxs","_jsxs","Characters","_ref","userName","_useState","_useState2","_slicedToArray","characters","setCharacters","_useState3","_useState4","query","setQuery","_useState5","_useState6","visiableCharacters","setVisiableCharacters","_useState7","_useState8","newQuery","setNewQuery","firstPage","countCardsOfPage","_useState9","_useState10","currentPage","setCurrentPage","_useState11","_useState12","recordsPerPage","indexOfLastRecord","indexOfFirstRecord","currentRecords","slice","nPages","Math","ceil","length","getQuery","sessionStorage","getItem","getCurrentPage","Number","checkIsNewQuery","handleChange","event","target","value","handleReturnToMainPage","window","setItem","JSON","stringify","String","location","reload","parse","className","children","href","onClick","src","alt","type","defaultValue","name","placeholder","onChange"],"sources":["/Users/stepan12/Documents/characters/Characters-app/src/pages/Characters/Characters.tsx"],"sourcesContent":["import React, { ChangeEvent, useEffect, useState } from 'react';\nimport './Characters.scss';\n\nimport CardList from '../../components/CardList/CardList';\nimport Pagination from '../../components/Pagination/Pagination';\nimport UserMenu from '../../components/UserMenu/UserMenu';\nimport Logo from '../../components/Logo/Logo';\n\nimport { filterByName } from '../../helpers/heplerFunction';\nimport { getCharacters } from '../../api/api';\n\nimport { Character } from '../../types';\n\nimport SearchIcon from '../../image/search.png';\nimport NoResults from '../../components/NoResults/NoResults';\n\ntype Props = {\n  userName: string;\n}\n\nconst Characters: React.FC<Props> = ({ userName }) => {\n  const [characters, setCharacters] = useState<Character[]>([]);\n  const [query, setQuery] = useState<string>('');\n  const [visiableCharacters, setVisiableCharacters] = useState<Character[]>([])\n  const [newQuery, setNewQuery] = useState<string>('')\n\n  const firstPage = 1;\n  const countCardsOfPage = 8;\n\n  const [currentPage, setCurrentPage] = useState(firstPage);\n  const [recordsPerPage] = useState(countCardsOfPage);\n  \n  const indexOfLastRecord = currentPage * recordsPerPage;\n  const indexOfFirstRecord = indexOfLastRecord - recordsPerPage;\n  const currentRecords = visiableCharacters.slice(indexOfFirstRecord, indexOfLastRecord);\n  const nPages = Math.ceil(visiableCharacters.length / recordsPerPage)\n\n  const getQuery = sessionStorage.getItem('query') || '';\n  \n  const getCurrentPage = sessionStorage.getItem('currentPage')\n    ?  Number(sessionStorage.getItem('currentPage'))\n    :  firstPage;\n\n  const checkIsNewQuery = newQuery !== null;\n\n  const handleChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setQuery(event.target.value)\n  }\n\n  const handleReturnToMainPage = () => {\n    window.sessionStorage.setItem('currentPage', JSON.stringify(String(firstPage)))\n    window.location.reload();\n  }\n\n  useEffect(() => {\n    if (userName) {\n      window.sessionStorage.setItem('userName', JSON.stringify(userName));\n    }\n  }, [userName]);\n\n  useEffect(() => {\n    if (visiableCharacters.length < (countCardsOfPage + 1)) {\n      setCurrentPage(firstPage);\n    }\n  }, [visiableCharacters.length])\n\n  useEffect(() => {\n    getCharacters(setCharacters);\n  }, [])\n\n  useEffect(() => {    \n    setVisiableCharacters(filterByName(characters, query));\n  }, [characters, query])\n\n  useEffect(() => {\n    if (checkIsNewQuery && query.length !== newQuery.length) {\n      window.sessionStorage.setItem('query', JSON.stringify(query));\n    }\n\n    if (currentPage >= firstPage) {\n      window.sessionStorage.setItem('currentPage', JSON.stringify(currentPage));\n    }\n  }, [query, currentPage])\n\n  useEffect(() => {\n    if (checkIsNewQuery) {\n      setQuery(newQuery);\n    }\n  }, [newQuery])\n\n  useEffect(() => {\n    if (checkIsNewQuery && getQuery) {\n      setNewQuery(JSON.parse(getQuery));\n    } \n  }, [getQuery])\n\n  useEffect(() => {\n    if (getCurrentPage && getCurrentPage > firstPage) {\n      setCurrentPage(getCurrentPage);\n    } \n  }, [])\n\n  return (\n    <div className='home-page'>\n      <div className='home-page__content'>\n        <section className='content'>\n          <UserMenu \n            userName={userName} \n          />\n\n          <header className='content-header'>\n            <a \n              href='/Characters-app/#/characters/#/'\n              className='home-page__logo'\n              onClick={handleReturnToMainPage}\n            >\n              <Logo />\n            </a>\n          </header>\n          \n          <form\n            className=\"search-form\"\n          >\n            <label>\n              <img\n                className='search-form__icon'\n                src={SearchIcon}\n                alt='SearchIcon'\n              />\n\n              <input \n                className=\"search-form__input\"\n                type=\"text\"\n                defaultValue={newQuery || ''}\n                name=\"search\"\n                placeholder=\"Filter by name...\"\n                onChange={handleChange}\n              />\n            </label>\n          </form>\n\n          {currentRecords.length !==0 \n            ?  <CardList characters={currentRecords} />\n            :  <NoResults />\n          }\n          \n        </section>\n        \n        <section className='pagination'>\n          <Pagination\n            nPages={nPages}\n            currentPage={currentPage}\n            setCurrentPage={setCurrentPage}\n          />\n        </section>\n\n        \n      </div>\n    </div>\n  )\n}\n\nexport default Characters;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}